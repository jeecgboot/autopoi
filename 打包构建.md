# AutoPOI æ‰“åŒ…æ„å»ºæŒ‡å—

## ğŸ“‹ JDK ç‰ˆæœ¬è¦æ±‚

ä¸åŒæ¨¡å—å¯¹ JDK ç‰ˆæœ¬æœ‰ä¸¥æ ¼è¦æ±‚ï¼š

| æ¨¡å— | ç¼–è¯‘ JDK | è¿è¡Œ JDK | è¯´æ˜ |
|------|---------|---------|------|
| `autopoi` | **JDK 8+** | JDK 8+ | æ ¸å¿ƒæ¨¡å—ï¼Œä½¿ç”¨ JDK 8 API |
| `autopoi-spring-boot-2-starter` | **JDK 8+** | JDK 8+ | Spring Boot 2.x å…¼å®¹ |
| `autopoi-spring-boot-3-starter` | **JDK 17+** | JDK 17+ | Spring Boot 3.x è¦æ±‚ |

## ğŸ”§ å…³é”®é…ç½®ï¼š`<release>` å‚æ•°

é¡¹ç›®ä¸­ä½¿ç”¨äº† `<release>` å‚æ•°æ¥ä¸¥æ ¼æ§åˆ¶ API ç‰ˆæœ¬ï¼š

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <release>8</release>  <!-- autopoi å’Œ spring-boot-2-starter -->
        <!-- æˆ– -->
        <release>17</release> <!-- spring-boot-3-starter -->
    </configuration>
</plugin>
```

**è¿™ä¸ªå‚æ•°çš„ç¥å¥‡ä¹‹å¤„ï¼š**
- âœ… **å³ä½¿ä½ åœ¨ IDEA ä¸­é€‰æ‹©äº† JDK 17ï¼Œç¼–è¯‘æ—¶ä¹Ÿåªèƒ½ä½¿ç”¨ JDK 8 çš„ API**
- âœ… å¦‚æœä»£ç ä¸­ä½¿ç”¨äº† JDK 9+ çš„ APIï¼ˆå¦‚ `List.of()`ï¼‰ï¼Œç¼–è¯‘ä¼šç›´æ¥å¤±è´¥
- âœ… ç”Ÿæˆçš„å­—èŠ‚ç ä¸æŒ‡å®šçš„ JDK ç‰ˆæœ¬å…¼å®¹

## ğŸš€ æ¨èçš„æ‰“åŒ…æ–¹å¼

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Maven å‘½ä»¤è¡Œï¼ˆæ¨èï¼‰

```bash
# å®Œæ•´æ„å»ºæ‰€æœ‰æ¨¡å—
mvn clean install

# è·³è¿‡æµ‹è¯•å¿«é€Ÿæ„å»º
mvn clean install -DskipTests

# åªæ„å»ºç‰¹å®šæ¨¡å—
cd autopoi
mvn clean install
```

### æ–¹å¼äºŒï¼šåœ¨ IntelliJ IDEA ä¸­æ‰“åŒ…

#### âš ï¸ é‡è¦æç¤º

ç”±äºé…ç½®äº† `<release>` å‚æ•°ï¼Œ**ä½ å¯ä»¥ç”¨ä»»ä½• JDK ç‰ˆæœ¬æ‰“åŒ…ï¼Œä½†æ¯ä¸ªæ¨¡å—ä¼šå¼ºåˆ¶ä½¿ç”¨å¯¹åº”ç‰ˆæœ¬çš„ APIï¼š**

| IDEA é€‰æ‹©çš„ JDK | autopoi | spring-boot-2-starter | spring-boot-3-starter |
|----------------|---------|---------------------|---------------------|
| JDK 8          | âœ… JDK 8 API | âœ… JDK 8 API | âŒ éœ€è¦ JDK 17+ |
| JDK 11         | âœ… JDK 8 API | âœ… JDK 8 API | âŒ éœ€è¦ JDK 17+ |
| JDK 17         | âœ… JDK 8 API | âœ… JDK 8 API | âœ… JDK 17 API |

**æ¨èï¼šä½¿ç”¨ JDK 17 æ‰“åŒ…æ‰€æœ‰æ¨¡å—ï¼**

#### IDEA é…ç½®æ­¥éª¤

1. æ‰“å¼€ IDEAï¼Œç‚¹å‡»å³ä¸Šè§’ Maven é¢æ¿
2. é€‰æ‹© JDK 17ï¼ˆå¯ä»¥æ„å»ºæ‰€æœ‰æ¨¡å—ï¼‰
3. åŒå‡» `Lifecycle` -> `install` æˆ– `package`

## ğŸ§ª éªŒè¯æ„å»ºç»“æœ

### éªŒè¯å­—èŠ‚ç ç‰ˆæœ¬

```bash
# Windows PowerShell
javap -v autopoi\target\classes\org\jeecgframework\poi\excel\ExcelExportUtil.class | Select-String "major version"
# è¾“å‡ºåº”è¯¥æ˜¯: major version: 52 (JDK 8)

javap -v autopoi-spring-boot-3-starter\target\classes\org\jeecgframework\poi\view\JeecgEntityExcelView.class | Select-String "major version"
# è¾“å‡ºåº”è¯¥æ˜¯: major version: 61 (JDK 17)
```

### æ£€æŸ¥ä¾èµ–

```bash
# éªŒè¯æ²¡æœ‰ poi-ooxml-schemas
mvn dependency:tree | findstr poi-ooxml-schemas
# åº”è¯¥æ²¡æœ‰è¾“å‡º
```

## âŒ å¸¸è§é”™è¯¯

### é”™è¯¯ï¼šä½¿ç”¨äº† JDK 9+ çš„ API

```java
// âŒ é”™è¯¯ï¼šautopoi æ¨¡å—ä¸­ä½¿ç”¨äº† JDK 9 çš„ API
List<String> list = List.of("a", "b", "c");

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ JDK 8 å…¼å®¹çš„å†™æ³•
List<String> list = Arrays.asList("a", "b", "c");
```

**ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼š**
```
[ERROR] cannot find symbol: method of(java.lang.String,java.lang.String,java.lang.String)
```

**è§£å†³æ–¹æ¡ˆï¼š** ä¿®æ”¹ä»£ç ï¼Œä½¿ç”¨ JDK 8 å…¼å®¹çš„ APIã€‚

## ğŸ“¦ å‘å¸ƒæ‰“åŒ…

```bash
# æ‰“åŒ…åˆ°æœ¬åœ°ä»“åº“
mvn clean install

# æ‰“åŒ…åˆ° Maven ä¸­å¤®ä»“åº“ï¼ˆä½¿ç”¨ release profileï¼‰
mvn clean deploy -P release
```

## ğŸ¯ æ€»ç»“

1. **`<release>` å‚æ•°æ˜¯å…³é”®** - æ— è®ºç”¨ä»€ä¹ˆ JDK ç¼–è¯‘ï¼Œéƒ½åªèƒ½ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ API
2. **æ¨èä½¿ç”¨ JDK 17 æ‰“åŒ…** - å¯ä»¥ä¸€æ¬¡æ€§æ„å»ºæ‰€æœ‰æ¨¡å—
3. **æ¯ä¸ªæ¨¡å—çš„ API å—åˆ°ä¸¥æ ¼é™åˆ¶** - autopoi å’Œ spring-boot-2-starter åªèƒ½ç”¨ JDK 8 API

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Maven Compiler Plugin - release parameter](https://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#release)
